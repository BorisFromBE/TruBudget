---
sidebar_position: 4
---

# Load and stress tests

TruBudget uses load and stress tests to ensure the system's stability. Some tests are triggered automatically after a major release, others run on each push to the remote repository or get triggered manually. The automated testing strategy allows to regularly check the system minimal requirements and adjust them as needed. Furthermore, developer get detailed information about the system allowing to search for flaws i.e. bottlenecks.

There three types of load/stress tests:

- Stress test: Classic stress to bring the core part of the system (API/Blockchain) to their limits. Although the system capacities are entirely used, the system should not crash nor be unusable
- Smoke Tests: Smoke test are regular load test, configured for minimal load. They are used for sanity checks.
- Stability Test: The whole system and it's interconnecting services such as Email Service and Storage Service are tested. This test, in terms of requests and users per second, is set up similarly to the stress test.

TruBudget uses [k6](https://k6.io) to define and run load and stability tests. Tests can be run both locally and using Docker. We highly recommend using docker since the [provided script](https://github.com/openkfw/TruBudget/tree/master/api/loadtest/runTests.sh) spins up a complete test setup including Grafana and Influx.
However, if you choose to run the tests locally, `k6` needs to be installed. An optional Grafana and Influx instance are not required, but recommended in order to analyze the data generated by the tests.
If you choose to run the tests within your CI/CD have a look at the `autotest` folder. The containing docker-setup will run `k6` in a dedicated docker container and can be fetched by Prometheus.( and send the test results to a Prometheus server using statsd.) The docker container can be run by running `` in the terminal. A Prometheus server must be provided.

# Visualizing

To visualize the generate data from the tests via Grafana:

- Open Grafana
- Navigate to Dashboard
- In the left sidebar, click the + button > Import
- Paste the Dashboard ID: 2587 or 11837
- Click Load
- Select the Influx datasource
- Click Import

# Minimum requirements

TruBudget load and stress tests are run against the minimum and recommend system requirements defied as follows:

**Blockchain**:

|         | Minimum   | Recommended |
| ------- | --------- | ----------- |
| CPU†    | 1 vCPU    | 2 vCPU      |
| RAM     | 4 GB      | 8 GB        |
| Storage | 50 GB     | 100 GB      |
| Network | U/D 1GB/s | U/D 10GB/s  |

**API**:

|         | Minimum   | Recommended |
| ------- | --------- | ----------- |
| CPU†    | 0.5 vCPU  | 1 vCPU      |
| RAM     | 2 GB      | 6 GB        |
| Storage | 1 GB      | 5 GB        |
| Network | U/D 1GB/s | U/D 10GB/s  |

**Export-Service**:

|         | Minimum   | Recommended |
| ------- | --------- | ----------- |
| CPU†    | 1 vCPU    | 2 vCPU      |
| RAM     | 3 GB      | 5 GB        |
| Storage | 50 GB     | 100 GB      |
| Network | U/D 1GB/s | U/D 10GB/s  |

**Storage-Service**:

|         | Minimum   | Recommended |
| ------- | --------- | ----------- |
| CPU†    | 1 vCPU    | 2 vCPU      |
| RAM     | 3 GB      | 5 GB        |
| Storage | 50 GB     | 100 GB      |
| Network | U/D 1GB/s | U/D 10GB/s  |

::note
† Depending on your or your provider's infrastructure, the strength of one virtual CPU might vary. The above values are based on the Intel® Xeon® Platinum 8272CL processor (second generation Intel® Xeon® Scalable processors), Intel® Xeon® 8171M 2.1GHz (Skylake), Intel® Xeon® E5-2673 v4 2.3 GHz (Broadwell), or the Intel® Xeon® E5-2673 v3 2.4 GHz (Haswell) processor.
::
